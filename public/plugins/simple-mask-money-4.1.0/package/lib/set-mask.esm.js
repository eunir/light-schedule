const e={allowNegative:!1,negativeSignAfter:!1,decimalSeparator:",",fixed:!0,fractionDigits:2,prefix:"",suffix:"",thousandsSeparator:".",cursor:"end",allowEmpty:!1};function t(t){return Object.assign(Object.assign({},e),t)}const n="0123456789".split("");function l(e,l){const r=t(l),{beforeFormat:i,afterFormat:o,allowNegative:s,negativeSignAfter:u,fractionDigits:a,decimalSeparator:c,thousandsSeparator:f,fixed:g,prefix:h,suffix:d,cursor:v,allowEmpty:p}=r;if("undefined"==typeof document)return()=>{};const m="string"==typeof e?document.querySelector(e):null!=e?e:null;if(null===m)return()=>{};if(!(m instanceof HTMLInputElement))throw new Error("the element must be an input");const y=g?"0":"_";m.hasAttribute("inputmode")||m.setAttribute("inputmode","numeric");const b=(e,t)=>{m.value=e,m.dispatchEvent(new InputEvent("input")),N(t),M=e,null==o||o(e)},k=h.length,w=[...n,"Backspace",s?"-":""],E=3+c.length+a,S=e=>{var t;return null!==(t=null==e?void 0:e.length)&&void 0!==t?t:m.value.length-d.length},x=e=>e<k,A=e=>d.length>0&&e>S(),L=(e,t=!1,n)=>{let l;const r=[...e];let i=new Array;if(n){[l]=n;const[,e]=n,[t,i]=e,o=r.splice(...e);if("remove"===l&&1===o.length){const[e]=o;e!==c&&e!==f||r.splice(t-1,i)}}let o=E,s=!1,g=0,v=!1;for(let e;e=r.pop();)if("-"!==e)if(e===c&&s&&t){const e=i.indexOf(c);i.splice(e,c.length);const t=i.slice(0,a);t.length<i.length&&(o+=i.length-t.length),i=[c,...t],s=!0}else Number.isNaN(Number(e))||(o-=1,e===y?g+=1:e!==c&&g>0&&(g=0),0===o&&(i.unshift(f),o=3),i.unshift(e),i.length!==a||s||(i.unshift(c),s=!0));else v=!0;return 0!==g&&i.splice(0,g),i.every((e=>e===y))&&"remove"===l&&(v=!1),i.length<=a?i=[y,c,i.join("").padStart(a,y)]:i.length===a+c.length&&i.unshift(y),v&&i[u?"push":"unshift"]("-"),(e=>`${h}${e}${d}`)(i.join(""))},N=e=>{const t=S();let n=[t,t];return"move"===v&&e&&(n="number"==typeof e[1]?[e[0],e[1]]:[e[0],e[0]]),m.setSelectionRange(...n),n};null==i||i(m.value);const j=L(m.value.split(""),!0);let M=j;const O=e=>{var t,n;null==i||i(m.value);const l=S();let r=null!==(t=m.selectionStart)&&void 0!==t?t:l,o=null!==(n=m.selectionEnd)&&void 0!==n?n:l;if(e.ctrlKey&&"a"===e.key)return N([k,l]);if(e.ctrlKey&&"z"===e.key)return b(j);if("move"===v&&("ArrowLeft"===e.key&&r>k||"ArrowRight"===e.key&&r<l))return;if(e.preventDefault(),e.ctrlKey&&"a"===e.key)return N([k,l]);if(!w.includes(e.key))return;const s="Backspace"===e.key;if(x(r)&&([r,o]=N([k])),A(r)&&([r,o]=N([l])),s&&0===r)return;if(p&&s&&m.value.length<=h.length+1)return void b(h);const u=m.value.split(""),a=Math.abs(o-r),c=a>0,f=c?[r,a]:[r-1,1],g=[r,c?a:0,e.key],d=s?"remove":"add",y=L(u,!1,[d,{add:g,remove:f}[d]]);if(!s&&M.length<y.length&&r<S(y))r+=y.length-M.length,o+=y.length-M.length;else if(s&&M.length>y.length&&r>k){const e=M.length-y.length;r=r-e<=k?k:r-e,o=o-e<=k?k:o-e}b(y,[r,o])},$=()=>{if(document.activeElement!==m)return;const e=m.selectionStart,t=m.selectionEnd;if("number"!=typeof e||"number"!=typeof t)return;let n;const l=x(e),r=A(t),i=A(e),o=x(t);(l||r||o||i)&&(n=[l?k:r?S():e,o?k:r?S():t]),n&&N(n)};m.addEventListener("keydown",O),document.addEventListener("selectionchange",$),b(p&&j===`${h}0`?"":j);const D=()=>{m.removeEventListener("keydown",O),document.removeEventListener("selectionchange",$),delete m.removeMask};return Object.defineProperty(m,"removeMask",{value:D,configurable:!0,enumerable:!0,writable:!0}),D}export{l as default};
//# sourceMappingURL=set-mask.esm.js.map
